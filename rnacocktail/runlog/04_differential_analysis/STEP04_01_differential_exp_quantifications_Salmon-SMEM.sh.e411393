INFO 2017-11-05 09:54:11,136 src.utils            Running RNASeqPipeline 0.2.1
INFO 2017-11-05 09:54:11,136 src.utils            Command-line /hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/scripts/run_rnacocktail.py diff --threads 5 --sample A1,A2 B1,B2 --outdir /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out --workdir /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work --ref_gtf /hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/example_small/Homo_sapiens.GRCh37.75.gtf --quant_files /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/A1/quant.sf,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/A2/quant.sf /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/B1/quant.sf,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/B2/quant.sf
INFO 2017-11-05 09:54:11,137 src.utils            Arguments are Namespace(R='R', alignments=[], alpha=0.05, difftool='DESeq2', featureCounts='featureCounts', featureCounts_opts='', mincount=2, mode='diff', outdir='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out', quant_files=['/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/A1/quant.sf,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/A2/quant.sf', '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/B1/quant.sf,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/B2/quant.sf'], ref_gtf='/hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/example_small/Homo_sapiens.GRCh37.75.gtf', sample=['A1,A2', 'B1,B2'], start=0, stringtie='stringtie', stringtie_merge_opts='', threads=5, timeout=10000000, transcripts_gtfs='', workdir='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work')
INFO 2017-11-05 09:54:11,137 src.utils            Run log will be saved in /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/logs/run-A1,A2-B1,B2-diff-20171105-095411.log
INFO 2017-11-05 09:54:11,137 src.utils            Run in mode: diff
INFO 2017-11-05 09:54:11,138 src.utils            Running differential analysis step using DESeq2
INFO 2017-11-05 09:54:11,138 src.run_diff         Running differential analysis (DESeq2) for A1,A2-B1,B2
INFO 2017-11-05 09:54:11,150 src.run_diff         --------------------------STEP 0--------------------------
INFO 2017-11-05 09:54:11,151 src.run_diff         Task: Erase DESeq2 work directory for A1,A2-B1,B2 
INFO 2017-11-05 09:54:11,151 src.run_diff         Running "bash -c rm -rf /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/*" 
INFO 2017-11-05 09:54:11,384 src.run_diff         Done Erase DESeq2 work directory for A1,A2-B1,B2 
INFO 2017-11-05 09:54:11,385 src.run_diff         Returned code 0 (0.229872 seconds)
INFO 2017-11-05 09:54:11,401 src.utils            Creating directory /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant
INFO 2017-11-05 09:54:11,412 src.run_diff         --------------------------STEP 1--------------------------
INFO 2017-11-05 09:54:11,783 src.run_diff         Will computed /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/tx2gene.csv as tx2gene.csv for A1,A2-B1,B2
INFO 2017-11-05 09:54:54,605 src.run_diff         --------------------------STEP 2--------------------------
INFO 2017-11-05 09:54:54,608 src.run_diff         Task: compute gene level abundances for A1,A2-B1,B2. 
INFO 2017-11-05 09:54:54,608 src.run_diff         Running "R -e library('readr'); library('tximport');                        samples=c('A1','A2','B1','B2'); (files <- file.path(c('/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/A1/quant.sf','/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/A2/quant.sf','/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/B1/quant.sf','/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/salmon_smem/B2/quant.sf'))); names(files) <- samples;                        tx2gene <- read.csv(file.path('/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/tx2gene.csv'),sep='\t');                        txi <- tximport(files, type = 'salmon', tx2gene = tx2gene);                        save(txi, file='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/txi.rda');                        write.table(txi$abundance, file = '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/txi.abundances',                       quote = FALSE, sep='\t');                        write.table(txi$length, file = '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/txi.length', quote = FALSE,                        sep='\t'); write.table(txi$counts, file = '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/txi.counts',                       quote = FALSE, sep='\t');" 
INFO 2017-11-05 09:56:39,038 src.run_diff         Done compute gene level abundances for A1,A2-B1,B2. 
INFO 2017-11-05 09:56:39,041 src.run_diff         Returned code 0 (104.204 seconds)
INFO 2017-11-05 09:56:39,041 src.run_diff         --------------------------STEP 3--------------------------
INFO 2017-11-05 09:56:39,045 src.run_diff         Task: DESeq2 for A1,A2-B1,B2 
INFO 2017-11-05 09:56:39,046 src.run_diff         Running "R -e library('DESeq2'); load('/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/txi.rda');                        condition <- factor(c(rep('C0', 2),rep('C1', 2)));                        (colData <- data.frame(row.names=colnames(txi$count), condition));                        counts <- round(txi$counts); mode(counts) <- 'integer';                         dds <- DESeqDataSetFromMatrix(countData=counts, colData=colData, design=~ condition);                         stopifnot(txi$countsFromAbundance %in% c('no','scaledTPM','lengthScaledTPM'));                          if (txi$countsFromAbundance %in% c('scaledTPM','lengthScaledTPM'))                          {    message('using just counts from tximport');  } else                          {    message('using counts and average transcript lengths from tximport');                          lengths <- txi$length;    dimnames(lengths) <- dimnames(dds);                         assays(dds)[['avgTxLength']] <- lengths;  };                          dds <- dds[ rowSums(counts(dds)) >= 2, ];                          dds$condition <- relevel(dds$condition, ref='C1');                          dds <- DESeq(dds); res <- results(dds, alpha=0.050000);                          (summary(res)); save(txi,colData,condition,dds,res,                          file='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/deseq2.rda');  write.table(res, file = '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/deseq2_res.tab',                          quote = FALSE, sep='\t');" 
INFO 2017-11-05 10:02:01,120 src.run_diff         Done DESeq2 for A1,A2-B1,B2 
INFO 2017-11-05 10:02:01,122 src.run_diff         Returned code 0 (322.038 seconds)
INFO 2017-11-05 10:02:01,128 src.run_diff         --------------------------STEP 4--------------------------
INFO 2017-11-05 10:02:01,129 src.run_diff         Task: Copy predictions to output directory for A1,A2-B1,B2. 
INFO 2017-11-05 10:02:01,129 src.run_diff         Running "cp /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/quant/deseq2_res.tab /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out/deseq2/A1,A2-B1,B2/quant/deseq2_res.tab" 
INFO 2017-11-05 10:02:01,292 src.run_diff         Done Copy predictions to output directory for A1,A2-B1,B2. 
INFO 2017-11-05 10:02:01,293 src.run_diff         Returned code 0 (0.0772712 seconds)
INFO 2017-11-05 10:02:01,293 src.run_diff         DESeq2 was successfull!
INFO 2017-11-05 10:02:01,293 src.run_diff         Output differential expressions: /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out/deseq2/A1,A2-B1,B2/quant/deseq2_res.tab
INFO 2017-11-05 10:02:01,294 src.utils            Run log is saved in /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/logs/run-A1,A2-B1,B2-diff-20171105-095411.log
INFO 2017-11-05 10:02:01,294 src.utils            All Done!
