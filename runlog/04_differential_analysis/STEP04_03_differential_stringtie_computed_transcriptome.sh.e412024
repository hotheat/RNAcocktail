INFO 2017-11-05 10:18:39,728 src.utils            Running RNASeqPipeline 0.2.1
INFO 2017-11-05 10:18:39,728 src.utils            Command-line /hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/scripts/run_rnacocktail.py diff --threads 5 --sample A1,A2 B1,B2 --outdir /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out --workdir /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work --ref_gtf /hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/example_small/Homo_sapiens.GRCh37.75.gtf --alignments /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A1/alignments.sorted.bam,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A2/alignments.sorted.bam /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B1/alignments.sorted.bam,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B2/alignments.sorted.bam --transcripts_gtfs /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/stringtie/A1/transcripts.gtf,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/stringtie/A2/transcripts.gtf /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/stringtie/B1/transcripts.gtf,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/stringtie/B2/transcripts.gtf --featureCounts featureCounts --featureCounts_opts 
INFO 2017-11-05 10:18:39,728 src.utils            Arguments are Namespace(R='R', alignments=['/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A1/alignments.sorted.bam,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A2/alignments.sorted.bam', '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B1/alignments.sorted.bam,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B2/alignments.sorted.bam'], alpha=0.05, difftool='DESeq2', featureCounts='featureCounts', featureCounts_opts='', mincount=2, mode='diff', outdir='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out', quant_files=[], ref_gtf='/hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/example_small/Homo_sapiens.GRCh37.75.gtf', sample=['A1,A2', 'B1,B2'], start=0, stringtie='stringtie', stringtie_merge_opts='', threads=5, timeout=10000000, transcripts_gtfs=['/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/stringtie/A1/transcripts.gtf,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/stringtie/A2/transcripts.gtf', '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/stringtie/B1/transcripts.gtf,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/stringtie/B2/transcripts.gtf'], workdir='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work')
INFO 2017-11-05 10:18:39,729 src.utils            Run log will be saved in /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/logs/run-A1,A2-B1,B2-diff-20171105-101839.log
INFO 2017-11-05 10:18:39,729 src.utils            Run in mode: diff
INFO 2017-11-05 10:18:39,729 src.utils            Running differential analysis step using DESeq2
INFO 2017-11-05 10:18:39,729 src.run_diff         Running differential analysis (DESeq2) for A1,A2-B1,B2
INFO 2017-11-05 10:18:39,749 src.run_diff         --------------------------STEP 0--------------------------
INFO 2017-11-05 10:18:39,749 src.run_diff         Task: Erase DESeq2 work directory for A1,A2-B1,B2 
INFO 2017-11-05 10:18:39,750 src.run_diff         Running "bash -c rm -rf /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/*" 
INFO 2017-11-05 10:18:39,842 src.run_diff         Done Erase DESeq2 work directory for A1,A2-B1,B2 
INFO 2017-11-05 10:18:39,843 src.run_diff         Returned code 0 (0.087918 seconds)
INFO 2017-11-05 10:18:39,848 src.utils            Creating directory /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf
INFO 2017-11-05 10:18:39,852 src.run_diff         --------------------------STEP 1--------------------------
INFO 2017-11-05 10:18:40,283 src.run_diff         Task: Merge transcripts GTFs for A1,A2-B1,B2 
INFO 2017-11-05 10:18:40,284 src.run_diff         Running "bash -c stringtie --merge  -G /hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/example_small/Homo_sapiens.GRCh37.75.gtf -p 5 -o /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/merged.gtf -v /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/gtfs_list.txt" 
INFO 2017-11-05 10:19:11,408 src.run_diff         Done Merge transcripts GTFs for A1,A2-B1,B2 
INFO 2017-11-05 10:19:11,409 src.run_diff         Returned code 0 (31.114 seconds)
INFO 2017-11-05 10:19:11,410 src.run_diff         --------------------------STEP 2--------------------------
INFO 2017-11-05 10:19:11,411 src.run_diff         Task: featureCounts for A1,A2-B1,B2 
INFO 2017-11-05 10:19:11,411 src.run_diff         Running "bash -c featureCounts -o /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/featureCounts.txt -T 5 -a /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/merged.gtf -g gene_id /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A1/alignments.sorted.bam /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A2/alignments.sorted.bam /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B1/alignments.sorted.bam /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B2/alignments.sorted.bam" 
INFO 2017-11-05 10:19:20,022 src.run_diff         Done featureCounts for A1,A2-B1,B2 
INFO 2017-11-05 10:19:20,023 src.run_diff         Returned code 0 (8.57157 seconds)
INFO 2017-11-05 10:19:20,023 src.run_diff         Task: featureCounts for A1,A2-B1,B2 
INFO 2017-11-05 10:19:20,024 src.run_diff         Running "bash -c sed -i -e '2s/.*/Geneid\tChr\tStart\tEnd\tStrand\tLength\tA1\tA2\tB1\tB2/' /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/featureCounts.txt" 
INFO 2017-11-05 10:19:20,315 src.run_diff         Done featureCounts for A1,A2-B1,B2 
INFO 2017-11-05 10:19:20,316 src.run_diff         Returned code 0 (0.274241 seconds)
INFO 2017-11-05 10:19:20,316 src.run_diff         --------------------------STEP 3--------------------------
INFO 2017-11-05 10:19:20,319 src.run_diff         Task: DESeq2 for A1,A2-B1,B2 
INFO 2017-11-05 10:19:20,319 src.run_diff         Running "R -e library('DESeq2'); countData <- read.table('/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/featureCounts.txt',                            header=TRUE, row.names=1);  countData <- countData[ ,6:ncol(countData)];                             countData <- as.matrix(countData);                            condition <- factor(c(rep('C0', 2),rep('C1', 2)));                            (colData <- data.frame(row.names=colnames(countData), condition));                            dds <- DESeqDataSetFromMatrix(countData=countData, colData=colData, design=~ condition);                             dds <- dds[ rowSums(counts(dds)) >= 2, ];                              dds$condition <- relevel(dds$condition, ref='C1');                              dds <- DESeq(dds); res <- results(dds, alpha=0.050000);                              (summary(res)); save(countData,colData,condition,dds,res,                              file='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/deseq2.rda');  write.table(res, file = '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/deseq2_res.tab',                              quote = FALSE, sep='\t');" 
INFO 2017-11-05 10:20:33,550 src.run_diff         Done DESeq2 for A1,A2-B1,B2 
INFO 2017-11-05 10:20:33,552 src.run_diff         Returned code 0 (73.1713 seconds)
INFO 2017-11-05 10:20:33,557 src.run_diff         --------------------------STEP 4--------------------------
INFO 2017-11-05 10:20:33,559 src.run_diff         Task: Copy predictions to output directory for A1,A2-B1,B2. 
INFO 2017-11-05 10:20:33,559 src.run_diff         Running "cp /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/merge_trans_gtf/deseq2_res.tab /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out/deseq2/A1,A2-B1,B2/merge_trans_gtf/deseq2_res.tab" 
INFO 2017-11-05 10:20:33,703 src.run_diff         Done Copy predictions to output directory for A1,A2-B1,B2. 
INFO 2017-11-05 10:20:33,704 src.run_diff         Returned code 0 (0.0643599 seconds)
INFO 2017-11-05 10:20:33,704 src.run_diff         DESeq2 was successfull!
INFO 2017-11-05 10:20:33,704 src.run_diff         Output differential expressions: /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out/deseq2/A1,A2-B1,B2/merge_trans_gtf/deseq2_res.tab
INFO 2017-11-05 10:20:33,705 src.utils            Run log is saved in /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/logs/run-A1,A2-B1,B2-diff-20171105-101839.log
INFO 2017-11-05 10:20:33,705 src.utils            All Done!
