INFO 2017-11-05 10:14:36,457 src.utils            Running RNASeqPipeline 0.2.1
INFO 2017-11-05 10:14:36,458 src.utils            Command-line /hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/scripts/run_rnacocktail.py diff --threads 5 --sample A1,A2 B1,B2 --outdir /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out --workdir /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work --ref_gtf /hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/example_small/Homo_sapiens.GRCh37.75.gtf --alignments /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A1/alignments.sorted.bam,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A2/alignments.sorted.bam /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B1/alignments.sorted.bam,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B2/alignments.sorted.bam
INFO 2017-11-05 10:14:36,458 src.utils            Arguments are Namespace(R='R', alignments=['/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A1/alignments.sorted.bam,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A2/alignments.sorted.bam', '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B1/alignments.sorted.bam,/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B2/alignments.sorted.bam'], alpha=0.05, difftool='DESeq2', featureCounts='featureCounts', featureCounts_opts='', mincount=2, mode='diff', outdir='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out', quant_files=[], ref_gtf='/hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/example_small/Homo_sapiens.GRCh37.75.gtf', sample=['A1,A2', 'B1,B2'], start=0, stringtie='stringtie', stringtie_merge_opts='', threads=5, timeout=10000000, transcripts_gtfs='', workdir='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work')
INFO 2017-11-05 10:14:36,459 src.utils            Run log will be saved in /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/logs/run-A1,A2-B1,B2-diff-20171105-101436.log
INFO 2017-11-05 10:14:36,459 src.utils            Run in mode: diff
INFO 2017-11-05 10:14:36,459 src.utils            Running differential analysis step using DESeq2
INFO 2017-11-05 10:14:36,459 src.run_diff         Running differential analysis (DESeq2) for A1,A2-B1,B2
INFO 2017-11-05 10:14:36,608 src.run_diff         --------------------------STEP 0--------------------------
INFO 2017-11-05 10:14:36,609 src.run_diff         Task: Erase DESeq2 work directory for A1,A2-B1,B2 
INFO 2017-11-05 10:14:36,609 src.run_diff         Running "bash -c rm -rf /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/*" 
INFO 2017-11-05 10:14:36,776 src.run_diff         Done Erase DESeq2 work directory for A1,A2-B1,B2 
INFO 2017-11-05 10:14:36,777 src.run_diff         Returned code 0 (0.162699 seconds)
INFO 2017-11-05 10:14:36,782 src.utils            Creating directory /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/ref_gtf
INFO 2017-11-05 10:14:36,790 src.run_diff         --------------------------STEP 1--------------------------
INFO 2017-11-05 10:14:36,793 src.run_diff         Task: featureCounts for A1,A2-B1,B2 
INFO 2017-11-05 10:14:36,793 src.run_diff         Running "bash -c featureCounts -o /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/ref_gtf/featureCounts.txt -T 5 -a /hwfssz1/ST_OCEAN/USER/guojiao1/app/rnacocktail-0.2.1/example_small/Homo_sapiens.GRCh37.75.gtf -g gene_id /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A1/alignments.sorted.bam /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/A2/alignments.sorted.bam /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B1/alignments.sorted.bam /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/hisat2/B2/alignments.sorted.bam" 
INFO 2017-11-05 10:14:59,944 src.run_diff         Done featureCounts for A1,A2-B1,B2 
INFO 2017-11-05 10:14:59,945 src.run_diff         Returned code 0 (23.1395 seconds)
INFO 2017-11-05 10:14:59,946 src.run_diff         Task: featureCounts for A1,A2-B1,B2 
INFO 2017-11-05 10:14:59,946 src.run_diff         Running "bash -c sed -i -e '2s/.*/Geneid\tChr\tStart\tEnd\tStrand\tLength\tA1\tA2\tB1\tB2/' /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/ref_gtf/featureCounts.txt" 
INFO 2017-11-05 10:15:00,246 src.run_diff         Done featureCounts for A1,A2-B1,B2 
INFO 2017-11-05 10:15:00,246 src.run_diff         Returned code 0 (0.286675 seconds)
INFO 2017-11-05 10:15:00,246 src.run_diff         --------------------------STEP 2--------------------------
INFO 2017-11-05 10:15:00,248 src.run_diff         Task: DESeq2 for A1,A2-B1,B2 
INFO 2017-11-05 10:15:00,248 src.run_diff         Running "R -e library('DESeq2'); countData <- read.table('/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/ref_gtf/featureCounts.txt',                            header=TRUE, row.names=1);  countData <- countData[ ,6:ncol(countData)];                             countData <- as.matrix(countData);                            condition <- factor(c(rep('C0', 2),rep('C1', 2)));                            (colData <- data.frame(row.names=colnames(countData), condition));                            dds <- DESeqDataSetFromMatrix(countData=countData, colData=colData, design=~ condition);                             dds <- dds[ rowSums(counts(dds)) >= 2, ];                              dds$condition <- relevel(dds$condition, ref='C1');                              dds <- DESeq(dds); res <- results(dds, alpha=0.050000);                              (summary(res)); save(countData,colData,condition,dds,res,                              file='/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/ref_gtf/deseq2.rda');  write.table(res, file = '/hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/ref_gtf/deseq2_res.tab',                              quote = FALSE, sep='\t');" 
INFO 2017-11-05 10:16:11,391 src.run_diff         Done DESeq2 for A1,A2-B1,B2 
INFO 2017-11-05 10:16:11,393 src.run_diff         Returned code 0 (71.0979 seconds)
INFO 2017-11-05 10:16:11,399 src.run_diff         --------------------------STEP 3--------------------------
INFO 2017-11-05 10:16:11,400 src.run_diff         Task: Copy predictions to output directory for A1,A2-B1,B2. 
INFO 2017-11-05 10:16:11,400 src.run_diff         Running "cp /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/deseq2/A1,A2-B1,B2/ref_gtf/deseq2_res.tab /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out/deseq2/A1,A2-B1,B2/ref_gtf/deseq2_res.tab" 
INFO 2017-11-05 10:16:11,488 src.run_diff         Done Copy predictions to output directory for A1,A2-B1,B2. 
INFO 2017-11-05 10:16:11,489 src.run_diff         Returned code 0 (0.0496359 seconds)
INFO 2017-11-05 10:16:11,489 src.run_diff         DESeq2 was successfull!
INFO 2017-11-05 10:16:11,489 src.run_diff         Output differential expressions: /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/out/deseq2/A1,A2-B1,B2/ref_gtf/deseq2_res.tab
INFO 2017-11-05 10:16:11,490 src.utils            Run log is saved in /hwfssz1/ST_OCEAN/USER/guojiao1/Project/RNAcocktail_test/work/logs/run-A1,A2-B1,B2-diff-20171105-101436.log
INFO 2017-11-05 10:16:11,490 src.utils            All Done!
